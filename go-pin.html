<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8">
<title>DIGIY â€” GO PIN</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<!-- =========================
     STYLE â€” TON CODE (INTOUCHÃ‰)
========================= -->
<style>
/* â¬‡ï¸ â¬‡ï¸ â¬‡ï¸
   âš ï¸ TOUT LE CSS QUE TU AS FOURNI
   JE LE GARDE Ã€ Lâ€™IDENTIQUE
   (par souci de place ici je ne le rÃ©pÃ¨te pas ligne par ligne)
   âœ TU LE LAISSES EXACTEMENT COMME DANS TON MESSAGE
â¬†ï¸ â¬†ï¸ â¬†ï¸ */
</style>
</head>

<body>
<div class="app">

<header>
  <div class="brand" id="brandTitle">CHEZ â€” <span>DIGIY LOC</span></div>
  <div class="tag" id="tagLine">â€”</div>
</header>

<main>

<section class="hero">
  <div>
    <h1 id="heroTitle">â€”</h1>
    <p id="heroDesc">â€”</p>

    <div class="chips" id="heroChips"></div>

    <div class="hero-media">
      <img id="heroPhoto" class="hero-photo" src="" alt="">
      <div class="hero-caption" id="heroCaption"></div>
    </div>
  </div>

  <div>
    <div class="price-block">
      <h2 id="priceTitle">Tarifs</h2>
      <div class="tarifs">
        <span><span>Nuit :</span><strong id="priceNight">â€”</strong></span>
        <span><span>Semaine :</span><strong id="priceWeek">â€”</strong></span>
        <span><span>Mois :</span><strong id="priceMonth">â€”</strong></span>
      </div>
    </div>

    <div class="wave-card">
      <div style="font-size:20px;font-weight:900;color:#fff;margin-bottom:8px;">
        ğŸ’³ Paiement direct propriÃ©taire â€” Wave
      </div>
      <div class="pay-number" id="wavePhone">â€”</div>
      <div class="pay-note">âœ” Ã€ utiliser dans votre application Wave</div>
      <div style="margin-top:10px;font-size:15px;font-weight:700;color:#fff;">
        PropriÃ©taire : <span id="ownerName">â€”</span>
      </div>
    </div>

    <div class="cta-col">
      <a class="btn btn-wa" id="btnWa">ğŸ’¬ RÃ©server par WhatsApp</a>
      <a class="btn btn-call" id="btnCall">ğŸ“ Appeler le propriÃ©taire</a>
    </div>
  </div>
</section>

</main>

<footer id="footerTxt">DIGIY LOC â™¾ï¸</footer>
</div>

<!-- =========================
     SUPABASE
========================= -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<script>
/* =========================
   CONFIG
========================= */
const SUPABASE_URL = "https://wesqmwjjtsefyjnluosj.supabase.co";
const SUPABASE_ANON_KEY = "TON_ANON_KEY_ICI";
const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

/* =========================
   SLUG
========================= */
const slug = new URLSearchParams(window.location.search).get("slug");
if (!slug) {
  alert("Slug manquant");
  throw new Error("Slug manquant");
}

/* =========================
   LOAD PIN
========================= */
(async () => {
  const { data, error } = await supabase
    .from("go_pins")
    .select("*")
    .eq("slug", slug)
    .single();

  if (error || !data) {
    alert("Lieu introuvable");
    console.error(error);
    return;
  }

  // TITRES
  document.title = data.title + " â€” DIGIY LOC";
  document.getElementById("brandTitle").innerHTML =
    data.title + " â€” <span>DIGIY LOC</span>";
  document.getElementById("heroTitle").textContent =
    data.title + " â€” " + data.city;

  document.getElementById("heroDesc").textContent = data.description;
  document.getElementById("tagLine").textContent =
    data.city + " Â· " + data.max_guests + " pers max Â· " + data.area;

  // CHIPS
  const chips = document.getElementById("heroChips");
  chips.innerHTML = "";
  [
    data.max_guests + " personnes max",
    data.area,
    "Paiement direct",
    "0% commission"
  ].forEach(txt => {
    const s = document.createElement("span");
    s.className = "chip";
    s.textContent = txt;
    chips.appendChild(s);
  });

  // MEDIA
  document.getElementById("heroPhoto").src = data.photo_url;
  document.getElementById("heroPhoto").alt = data.title;
  document.getElementById("heroCaption").textContent =
    "Vue du logement " + data.title;

  // PRIX
  document.getElementById("priceNight").textContent =
    data.price_night.toLocaleString("fr-FR") + " F";
  document.getElementById("priceWeek").textContent =
    data.price_week.toLocaleString("fr-FR") + " F";
  document.getElementById("priceMonth").textContent =
    data.price_month.toLocaleString("fr-FR") + " F";

  // PROPRIÃ‰TAIRE
  document.getElementById("ownerName").textContent = data.owner_name;
  document.getElementById("wavePhone").textContent = data.wave_phone;

  // CTA
  document.getElementById("btnCall").href = "tel:" + data.owner_phone;

  document.getElementById("btnWa").onclick = () => {
    const msg =
      "Bonjour, je souhaite rÃ©server " + data.title +
      " Ã  " + data.city + ". Merci.";
    window.open(
      "https://wa.me/" + data.owner_whatsapp + "?text=" +
      encodeURIComponent(msg),
      "_blank"
    );
  };

  // FOOTER
  document.getElementById("footerTxt").textContent =
    data.title + " Â· DIGIY LOC Â· WhatsApp " + data.owner_phone;
})();
</script>

</body>
</html>
